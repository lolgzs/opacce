<?php
/**
 * Copyright (c) 2012, Agence FranÃ§aise Informatique (AFI). All rights reserved.
 *
 * AFI-OPAC 2.0 is free software; you can redistribute it and/or modify
 * it under the terms of the GNU AFFERO GENERAL PUBLIC LICENSE as published by
 * the Free Software Foundation.
 *
 * There are special exceptions to the terms and conditions of the AGPL as it
 * is applied to this software (see README file).
 *
 * AFI-OPAC 2.0 is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU AFFERO GENERAL PUBLIC LICENSE for more details.
 *
 * You should have received a copy of the GNU AFFERO GENERAL PUBLIC LICENSE
 * along with AFI-OPAC 2.0; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301  USA 
 */

class MultimediaTest extends PHPUnit_Framework_TestCase {
	/** @test */
	public function validHashShouldBeValid() {
		Class_Multimedia::setInstance(new Class_MultimediaTesting);

		$this->assertTrue(Class_Multimedia::isValidHash(
				'b2d76718d5ba373c8c65b1dd9c724e7b', //'a1e3bdf173b8060891fb4c8af6099e10',
				'[{"libelle":"Actualit\u00e9","id":"5","site":{"id":"1","libelle":"antibes"},"postes":[{"id":"44","libelle":"ANACTU05","os":"Windows XP","maintenance":"0"},{"id":"46","libelle":"ANACTU04","os":"Windows XP","maintenance":"0"},{"id":"48","libelle":"ANACTU12","os":"Windows XP","maintenance":"0"},{"id":"49","libelle":"ANACTU11","os":"Windows XP","maintenance":"0"},{"id":"50","libelle":"ANACTU10","os":"Windows XP","maintenance":"0"},{"id":"51","libelle":"ANACTU08","os":"Windows XP","maintenance":"0"},{"id":"52","libelle":"ANACTU06","os":"Windows XP","maintenance":"0"},{"id":"62","libelle":"ANACTU07","os":"Windows XP","maintenance":"0"},{"id":"63","libelle":"ANACTU13","os":"Windows XP","maintenance":"0"},{"id":"64","libelle":"ANACTU09","os":"Windows XP","maintenance":"0"}]},{"libelle":"default","id":"1","site":{"id":"1","libelle":"antibes"},"postes":[{"id":"77","libelle":"ANFICT30","os":"Windows XP","maintenance":"0"}]},{"libelle":"Documentation","id":"3","site":{"id":"1","libelle":"antibes"},"postes":[{"id":"13","libelle":"ANDOCU07","os":"Windows XP","maintenance":"0"},{"id":"14","libelle":"ANDOCU05","os":"Windows XP","maintenance":"0"},{"id":"15","libelle":"ANDOCU06","os":"Windows XP","maintenance":"0"},{"id":"17","libelle":"ANDOCU10","os":"Windows XP","maintenance":"0"},{"id":"18","libelle":"ANDOCU09","os":"Windows XP","maintenance":"0"},{"id":"20","libelle":"ANDOCU12","os":"Windows XP","maintenance":"0"},{"id":"21","libelle":"ANDOCU11","os":"Windows XP","maintenance":"0"},{"id":"22","libelle":"ANDOCU04","os":"Windows XP","maintenance":"0"},{"id":"57","libelle":"ANDOCU14","os":"Windows XP","maintenance":"0"},{"id":"59","libelle":"ANDOCU15","os":"Windows XP","maintenance":"0"},{"id":"61","libelle":"ANDOCU16","os":"Windows XP","maintenance":"0"}]},{"libelle":"Fiction","id":"2","site":{"id":"1","libelle":"antibes"},"postes":[{"id":"9","libelle":"ANFICT03","os":"Windows XP","maintenance":"0"},{"id":"10","libelle":"ANFICT04","os":"Windows XP","maintenance":"0"},{"id":"11","libelle":"ANFICT02","os":"Windows XP","maintenance":"0"},{"id":"12","libelle":"ANFICT01","os":"Windows XP","maintenance":"0"},{"id":"66","libelle":"ANFICT05","os":"Windows 7","maintenance":"0"}]},{"libelle":"Handicap\u00e9","id":"8","site":{"id":"1","libelle":"antibes"},"postes":[{"id":"42","libelle":"ANFICT10","os":"Windows XP","maintenance":"0"},{"id":"43","libelle":"ANFICT11","os":"Windows XP","maintenance":"0"}]},{"libelle":"Jeunesse","id":"6","site":{"id":"1","libelle":"antibes"},"postes":[{"id":"26","libelle":"ANJEUN02","os":"Windows XP","maintenance":"0"},{"id":"27","libelle":"ANJEUN03","os":"Windows XP","maintenance":"0"},{"id":"28","libelle":"ANJEUN04","os":"Windows XP","maintenance":"0"},{"id":"29","libelle":"ANJEUN05","os":"Windows XP","maintenance":"0"},{"id":"30","libelle":"ANJEUN08","os":"Windows XP","maintenance":"0"},{"id":"31","libelle":"ANJEUN06","os":"Windows XP","maintenance":"0"},{"id":"32","libelle":"ANJEUN09","os":"Windows XP","maintenance":"0"},{"id":"33","libelle":"ANJEUN07","os":"Windows XP","maintenance":"0"},{"id":"56","libelle":"ANJEUN10","os":"Windows XP","maintenance":"0"}]},{"libelle":"Musique","id":"4","site":{"id":"1","libelle":"antibes"},"postes":[{"id":"38","libelle":"ANMUSI04","os":"Windows XP","maintenance":"0"},{"id":"39","libelle":"ANMUSI03","os":"Windows XP","maintenance":"0"},{"id":"40","libelle":"ANMUSI06","os":"Windows XP","maintenance":"0"},{"id":"41","libelle":"ANMUSI05","os":"Windows XP","maintenance":"0"}]},{"libelle":"Opac","id":"7","site":{"id":"1","libelle":"antibes"},"postes":[{"id":"4","libelle":"ANFICT06","os":"Windows XP","maintenance":"0"},{"id":"7","libelle":"ANFICT07","os":"Windows XP","maintenance":"0"},{"id":"8","libelle":"ANFICT08","os":"Windows XP","maintenance":"0"},{"id":"19","libelle":"ANDOCU08","os":"Windows XP","maintenance":"0"},{"id":"23","libelle":"ANDOCU13","os":"Windows XP","maintenance":"0"},{"id":"24","libelle":"ANDOCU02","os":"Windows XP","maintenance":"0"},{"id":"25","libelle":"ANDOCU01","os":"Windows XP","maintenance":"0"},{"id":"34","libelle":"ANJEUN11","os":"Windows XP","maintenance":"0"},{"id":"35","libelle":"ANJEUN01","os":"Windows XP","maintenance":"0"},{"id":"36","libelle":"ANMUSI02","os":"Windows XP","maintenance":"0"},{"id":"37","libelle":"ANMUSI01","os":"Windows XP","maintenance":"0"},{"id":"45","libelle":"ANACTU03","os":"Windows XP","maintenance":"0"},{"id":"47","libelle":"ANACTU02","os":"Windows XP","maintenance":"0"},{"id":"65","libelle":"ANACTU01","os":"Windows XP","maintenance":"0"}]}]'));
	}


	/** @test */
	public function invalidHashShouldNotBeValid() {
		Class_Multimedia::setInstance(new Class_MultimediaTesting);
		$this->assertFalse(Class_Multimedia::isValidHash(
				'3dd16uiessseruiest8973iue98759',
				'[{"libelle":"Actualit\u00e9","id":"5","site":{"id":"1","libelle":"antibes"},"postes":[{"id":"44","libelle":"ANACTU05","os":"Windows XP","maintenance":"0"},{"id":"46","libelle":"ANACTU04","os":"Windows XP","maintenance":"0"},{"id":"48","libelle":"ANACTU12","os":"Windows XP","maintenance":"0"},{"id":"49","libelle":"ANACTU11","os":"Windows XP","maintenance":"0"},{"id":"50","libelle":"ANACTU10","os":"Windows XP","maintenance":"0"},{"id":"51","libelle":"ANACTU08","os":"Windows XP","maintenance":"0"},{"id":"52","libelle":"ANACTU06","os":"Windows XP","maintenance":"0"},{"id":"62","libelle":"ANACTU07","os":"Windows XP","maintenance":"0"},{"id":"63","libelle":"ANACTU13","os":"Windows XP","maintenance":"0"},{"id":"64","libelle":"ANACTU09","os":"Windows XP","maintenance":"0"}]},{"libelle":"default","id":"1","site":{"id":"1","libelle":"antibes"},"postes":[{"id":"77","libelle":"ANFICT30","os":"Windows XP","maintenance":"0"}]},{"libelle":"Documentation","id":"3","site":{"id":"1","libelle":"antibes"},"postes":[{"id":"13","libelle":"ANDOCU07","os":"Windows XP","maintenance":"0"},{"id":"14","libelle":"ANDOCU05","os":"Windows XP","maintenance":"0"},{"id":"15","libelle":"ANDOCU06","os":"Windows XP","maintenance":"0"},{"id":"17","libelle":"ANDOCU10","os":"Windows XP","maintenance":"0"},{"id":"18","libelle":"ANDOCU09","os":"Windows XP","maintenance":"0"},{"id":"20","libelle":"ANDOCU12","os":"Windows XP","maintenance":"0"},{"id":"21","libelle":"ANDOCU11","os":"Windows XP","maintenance":"0"},{"id":"22","libelle":"ANDOCU04","os":"Windows XP","maintenance":"0"},{"id":"57","libelle":"ANDOCU14","os":"Windows XP","maintenance":"0"},{"id":"59","libelle":"ANDOCU15","os":"Windows XP","maintenance":"0"},{"id":"61","libelle":"ANDOCU16","os":"Windows XP","maintenance":"0"}]},{"libelle":"Fiction","id":"2","site":{"id":"1","libelle":"antibes"},"postes":[{"id":"9","libelle":"ANFICT03","os":"Windows XP","maintenance":"0"},{"id":"10","libelle":"ANFICT04","os":"Windows XP","maintenance":"0"},{"id":"11","libelle":"ANFICT02","os":"Windows XP","maintenance":"0"},{"id":"12","libelle":"ANFICT01","os":"Windows XP","maintenance":"0"},{"id":"66","libelle":"ANFICT05","os":"Windows 7","maintenance":"0"}]},{"libelle":"Handicap\u00e9","id":"8","site":{"id":"1","libelle":"antibes"},"postes":[{"id":"42","libelle":"ANFICT10","os":"Windows XP","maintenance":"0"},{"id":"43","libelle":"ANFICT11","os":"Windows XP","maintenance":"0"}]},{"libelle":"Jeunesse","id":"6","site":{"id":"1","libelle":"antibes"},"postes":[{"id":"26","libelle":"ANJEUN02","os":"Windows XP","maintenance":"0"},{"id":"27","libelle":"ANJEUN03","os":"Windows XP","maintenance":"0"},{"id":"28","libelle":"ANJEUN04","os":"Windows XP","maintenance":"0"},{"id":"29","libelle":"ANJEUN05","os":"Windows XP","maintenance":"0"},{"id":"30","libelle":"ANJEUN08","os":"Windows XP","maintenance":"0"},{"id":"31","libelle":"ANJEUN06","os":"Windows XP","maintenance":"0"},{"id":"32","libelle":"ANJEUN09","os":"Windows XP","maintenance":"0"},{"id":"33","libelle":"ANJEUN07","os":"Windows XP","maintenance":"0"},{"id":"56","libelle":"ANJEUN10","os":"Windows XP","maintenance":"0"}]},{"libelle":"Musique","id":"4","site":{"id":"1","libelle":"antibes"},"postes":[{"id":"38","libelle":"ANMUSI04","os":"Windows XP","maintenance":"0"},{"id":"39","libelle":"ANMUSI03","os":"Windows XP","maintenance":"0"},{"id":"40","libelle":"ANMUSI06","os":"Windows XP","maintenance":"0"},{"id":"41","libelle":"ANMUSI05","os":"Windows XP","maintenance":"0"}]},{"libelle":"Opac","id":"7","site":{"id":"1","libelle":"antibes"},"postes":[{"id":"4","libelle":"ANFICT06","os":"Windows XP","maintenance":"0"},{"id":"7","libelle":"ANFICT07","os":"Windows XP","maintenance":"0"},{"id":"8","libelle":"ANFICT08","os":"Windows XP","maintenance":"0"},{"id":"19","libelle":"ANDOCU08","os":"Windows XP","maintenance":"0"},{"id":"23","libelle":"ANDOCU13","os":"Windows XP","maintenance":"0"},{"id":"24","libelle":"ANDOCU02","os":"Windows XP","maintenance":"0"},{"id":"25","libelle":"ANDOCU01","os":"Windows XP","maintenance":"0"},{"id":"34","libelle":"ANJEUN11","os":"Windows XP","maintenance":"0"},{"id":"35","libelle":"ANJEUN01","os":"Windows XP","maintenance":"0"},{"id":"36","libelle":"ANMUSI02","os":"Windows XP","maintenance":"0"},{"id":"37","libelle":"ANMUSI01","os":"Windows XP","maintenance":"0"},{"id":"45","libelle":"ANACTU03","os":"Windows XP","maintenance":"0"},{"id":"47","libelle":"ANACTU02","os":"Windows XP","maintenance":"0"},{"id":"65","libelle":"ANACTU01","os":"Windows XP","maintenance":"0"}]}]'));
	}
}


class Class_MultimediaTesting extends Class_Multimedia {
	public function getKey() {return 'a7de41db2505672d8052117869c08517';}
	public function getDate() {return '2012-07-17';}
}