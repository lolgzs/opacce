(function(a){function y(){var b=k.scrollLeft(),c=k.width();a([d,m]).css("left",b+c/2);z&&a(e).css({left:b,top:k.scrollTop(),width:c,height:k.height()})}function A(b){b?a("object").add(B?"select":"embed").each(function(a,b){u[a]=[b,b.style.visibility];b.style.visibility="hidden"}):(a.each(u,function(a,b){b[0].style.visibility=b[1]}),u=[]);b=b?"bind":"unbind";k[b]("scroll resize",y);a(document)[b]("keydown",K)}function K(b){var b=b.keyCode,d=a.inArray;return 0<=d(b,c.closeKeys)?C():0<=d(b,c.nextKeys)?
D():0<=d(b,c.previousKeys)?E():!1}function E(){return v(n)}function D(){return v(p)}function v(a){0<=a&&(g=a,q=h[g][0],n=(g||(c.loop?h.length:0))-1,p=(g+1)%h.length||(c.loop?0:-1),F(),d.className="lbLoading",i=new Image,i.onload=L,i.src=q);return!1}function L(){d.className="";a(l).css({backgroundImage:"url("+q+")",visibility:"hidden",display:""});a(w).width(i.width);a([w,r,s]).height(i.height);a(G).html(h[g][1]||"");a(H).html((1<h.length&&c.counterText||"").replace(/{x}/,g+1).replace(/{y}/,h.length));
0<=n&&(I.src=h[n][0]);0<=p&&(J.src=h[p][0]);f=l.offsetWidth;j=l.offsetHeight;var b=Math.max(0,x-j/2);d.offsetHeight!=j&&a(d).animate({height:j,top:b},c.resizeDuration,c.resizeEasing);d.offsetWidth!=f&&a(d).animate({width:f,marginLeft:-f/2},c.resizeDuration,c.resizeEasing);a(d).queue(function(){a(m).css({width:f,top:b+j,marginLeft:-f/2,visibility:"hidden",display:""});a(l).css({display:"none",visibility:"",opacity:""}).fadeIn(c.imageFadeDuration,M)})}function M(){0<=n&&a(r).show();0<=p&&a(s).show();
a(t).css("marginTop",-t.offsetHeight).animate({marginTop:0},c.captionAnimationDuration);m.style.visibility=""}function F(){i.onload=null;i.src=I.src=J.src=q;a([d,l,t]).stop(!0);a([r,s,l,m]).hide()}function C(){0<=g&&(F(),g=n=p=-1,a(d).hide(),a(e).stop().fadeOut(c.overlayFadeDuration,A));return!1}var k=a(window),c,h,g=-1,q,n,p,z,x,f,j,B=!window.XMLHttpRequest,u=[],i={},I=new Image,J=new Image,e,d,l,w,r,s,m,t,G,H;a(function(){a("body").append(a([e=a('<div id="lbOverlay" />')[0],d=a('<div id="lbCenter" />')[0],
m=a('<div id="lbBottomContainer" />')[0]]).css("display","none"));l=a('<div id="lbImage" />').appendTo(d).append(w=a('<div style="position: relative;" />').append([r=a('<a id="lbPrevLink" href="#" />').click(E)[0],s=a('<a id="lbNextLink" href="#" />').click(D)[0]])[0])[0];t=a('<div id="lbBottom" />').appendTo(m).append([a('<a id="lbCloseLink" href="#" />').add(e).click(C)[0],G=a('<div id="lbCaption" />')[0],H=a('<div id="lbNumber" />')[0],a('<div style="clear: both;" />')[0]])[0]});a.slimbox=function(b,
g,i){c=a.extend({loop:!1,overlayOpacity:0.8,overlayFadeDuration:400,resizeDuration:400,resizeEasing:"swing",initialWidth:250,initialHeight:250,imageFadeDuration:400,captionAnimationDuration:400,counterText:"Image {x} of {y}",closeKeys:[27,88,67],previousKeys:[37,80],nextKeys:[39,78]},i);"string"==typeof b&&(b=[[b,g]],g=0);x=k.scrollTop()+k.height()/2;f=c.initialWidth;j=c.initialHeight;a(d).css({top:Math.max(0,x-j/2),width:f,height:j,marginLeft:-f/2}).show();if(z=B||e.currentStyle&&"fixed"!=e.currentStyle.position)e.style.position=
"absolute";a(e).css("opacity",c.overlayOpacity).fadeIn(c.overlayFadeDuration);y();A(1);h=b;c.loop=c.loop&&1<h.length;return v(g)};a.fn.slimbox=function(b,c,d){var c=c||function(a){return[a.href,a.title]},d=d||function(){return!0},g=this;return g.unbind("click").click(function(h){h.stopImmediatePropagation();var i=this,h=0,f,e=0,j;f=a.grep(g,function(a,b){return d.call(i,a,b)});for(j=f.length;e<j;++e)f[e]==i&&(h=e),f[e]=c(f[e],e);return a.slimbox(f,h,b)})}})(jQuery);
